
import("rtt_ros");
ros.import("oro_barrett_sim");
ros.import("rtt_rosclock");

// Loaded in plugin
//loadComponent("barrett_manager","oro_barrett_sim::BarrettSimManager");
//setActivity("scheme",0.001,LowestPriority,ORO_SCHED_OTHER)
barrett_manager.setPeriod(0.001);
loadService("barrett_manager","sim_clock_activity");
loadService("barrett_manager","rosparam");

barrett_manager.rosparam.getAll();
barrett_manager.rosparam.getAbsolute("robot_description");

barrett_manager.configure();
barrett_manager.configureWam7("wam");

/* Set home positions */
barrett_manager.wam.home_position[0] = 0.0;
barrett_manager.wam.home_position[1] = -1.5708;
barrett_manager.wam.home_position[2] = 0.0;
barrett_manager.wam.home_position[3] = 3.1415;
barrett_manager.wam.home_position[4] = 0.0;
barrett_manager.wam.home_position[5] = -1.5708;
barrett_manager.wam.home_position[6] = 1.5708;

/* Publish joint state to ROS */
stream("barrett_manager.wam.joint_state_out",ros.topic("joint_states"));

barrett_manager.start();

/* Calibrate joint positions */
// barrett_manager.wam.calibrateNearHome()
